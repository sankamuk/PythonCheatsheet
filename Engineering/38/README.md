
# Flask

It's a Python based Web Development framework that comes with minimum features and also minimum code is needed to get 
going. Flask is not opinionated thus its general purpose and can serve any need. Also, because if minimum feature user 
does not lose out on anything as its build to be extended with extension modules available for different usages. 
Thus, with Flask you get both flexibility and power at the same time topped with simplicity.


Flask core mostly relies on **Jinja** for templating and **Werkzeug** for HTTP and route functionality.
Flask also comes with development and unit testing support.


## Installation

```commandline
python -m pip install flask
```


## First Application

Our first [application](./app01/app.py) and to execute it we do below.

- Windows

```commandline
set FLASK_APP=app.py
set FLASK_ENV=development
flask run
```

> Note there is no space before of after = in set command. Also, development enables debug mode.


- Unix

```commandline
export FLASK_APP=app.py
export FLASK_ENV=development
flask run
```

On execution, you will get URL to connect!

```commandline
PS C:\Users\HP\OneDrive\Desktop\work\PythonCheatsheet\Engineering\38\app01> flask run
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:5000
Press CTRL+C to quit
```

> You can also execute application directly using `python -m flask run`
> Note you cannot override view function and will lead to app failure.

## Understanding Flow

Flask application initiated with Application objects run instance and waits for user interaction. Once user connects and
request for web resource belonging to specific URL flask invokes corresponding View function. Thus, It's once global 
instance that handles all users request, this is best understand by getting a global variable in our different request.

Example [application](./app02/app.py) once you execute, you can get page count increase for every request.

To view the URL mapping created for application can be easily extracted by calling `url_map` on app object.

```python
>>> from app import app
>>> app.url_map
Map([<Rule '/static/<filename>' (HEAD, GET, OPTIONS) -> static>,
 <Rule '/' (HEAD, GET, OPTIONS) -> index_f>])
```

## Model-Template-View Pattern

In place of MVC pattern for web development Flask generally use MTV pattern. This is not really different from MVC but 
just more Flask-ish.


## Template

Flask uses jinja as its template engine and using it one can have dedicated non Pythonic HTML code in template file 
which can be dynamically updated with data generated by View function and render it to the Web request handler. As a
convention ( strict dependency while Flask is non-opinionated :D ) it's named as `templates`.

Example [application](./app03/app.py) once you execute, you can get page created from 
[template](./app03/templates/index.html).

> Note how the template variable is passed in from Flask for rendering.
> Also note the use of static page.

In example [application](./app04/app.py) once you execute, you can view how complex object is templated. 


## Application Logic

To make things more interesting in next [application](./app05/app.py) we show how we dynamically **_pass input_** to 
view. Also, we show make perform **_operation inside the template_** and finally use `url_for` to refer to endpoint 
with view function name along with its parameters.

In [application](./app06/app.py) we show how we can use condition statement in Jinja.

Next in [application](./app07/app.py) we see how we can use loops in Jinja.

>> Note how we access loop index inside Jinja.


## REST API

Flask is perfect framework to build REST API. Detail about REST can be found 
[here](https://www.ibm.com/in-en/topics/rest-apis).

In example [application](./app08/app.py) we see how we can expose two REST endpoint `/api/user/<id>` and `/api/users` 
using Flask. Actually the magic function `jsonify` is literally handling the task for us.


## Forms

HTML Forms help in client input data for the Application to process. Detail can be found 
[here](https://www.w3schools.com/html/html_forms.asp).

In example [application](./app09/app.py) we see how we created two different form first to view a particular user and 
also to create new user. 

>> Note the method specification for View and how in case of post method the view function serves dual function.
>> Note how `redirect` is used to route post response.
>> Note the way record is deleted using a post with URL parameter rather than request body.


